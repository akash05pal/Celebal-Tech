SELECT HACKER_ID, NAME, SUM(SCORE) FROM (SELECT HACKER_ID, CHALLENGE_ID, MAX(SCORE) AS SCORE FROM SUBMISSIONS GROUP BY HACKER_ID, CHALLENGE_ID) AS SCORES JOIN HACKERS USING(HACKER_ID) GROUP BY HACKER_ID, NAME HAVING SUM(SCORE) > 0 ORDER BY SUM(SCORE) DESC, HACKER_ID; 